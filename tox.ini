[tox]
minversion = 3.3
envlist = py{38,39,310}
isolated_build = True

[testenv]
setenv =
    PYTHONHASHSEED = 100
deps =
;    pretend
;    pytest
;    pytest-cov
passenv =
    PYTHONPATH
commands =
;    pytest {posargs:--cov-report term-missing --cov-report html}

[testenv:format]
deps =
    isort
    black
commands =
    isort src/ tests/
    black src/ tests/


[testenv:build]
deps =
    check-manifest
    build
commands =
    python -c "import shutil; shutil.rmtree('dist', ignore_errors=True)"
    check-manifest --ignore 'tox.ini,tests/**,.idea/**'
    python -m build


[testenv:publish]
deps =
    twine
passenv =
    TWINE_PASSWORD
    TWINE_REPOSITORY
setenv =
    TWINE_USERNAME = {env:TWINE_USERNAME:__token__}
commands =
    python -m twine upload dist/*
